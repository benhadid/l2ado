<!DOCTYPE html>
<html>

  <head>
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5KMKZK4Z38"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5KMKZK4Z38');
  </script>
  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title> Compilation et débogage de programmes C sous environnement UN*X - Architecture des ordinateurs / Automne 2024 </title>
  <meta name="description" content="Objectifs      Initiation aux commandes de base du shell UN*X.        Introduction à l’outil GDB pour acquérir une expérience pratique dans le débogage de pr...">
  
  <!--for gitlab pages -->
  

  <!-- automatic favicons -->
  

    <!--for github pages -->
  <link rel="shortcut icon" href="https://benhadid.github.io/l2ado/favicon.ico?"> 
  <!--for github-->

  <link rel="stylesheet" href="/l2ado/fr/_css/main.css">
  <link rel="canonical" href="https://benhadid.github.io/l2ado/fr/labs/fr/01_lab">
  <link rel="alternate" type="application/rss+xml" title="Architecture des ordinateurs / Automne 2024 - " href="https://benhadid.github.io/l2ado/fr/feed.xml" />

  <link rel='stylesheet' id='open-sans-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&#038;subset=latin%2Clatin-ext&#038;ver=4.2.4' type='text/css' media='all' />
  <link href='https://fonts.googleapis.com/css?family=Titillium+Web:600italic,600,400,400italic' rel='stylesheet' type='text/css'>

  

  

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

  <!-- MathJax -->
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper" style="z-index: 100;">
      <table><tr>
          <td><img width="75" src="/l2ado/_images/logo.png" valign="middle"></td>
          <td style="padding-left:10px;">
<a class="schoolname" style="font-size: 15px;" href=""></a>
          <br>      
          <span style="margin-top: -2px;margin-bottom: -10px;" class="site-title"><a href="/l2ado/fr/" title="Architecture des ordinateurs / Automne 2024 - "><b>Architecture des ordinateurs</b></a></span>
          <br>
          <span class="coursesemeter" style="font-size: 12px;font-weight: bold;margin-top: 10px;display: block;">Automne 2024</span>
          </td>
        </tr></table>

    <nav class="site-nav">

      <a href="#" class="menu-icon menu.open">
        <svg viewbox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
        </svg>
      </a>  

    <div class="trigger">
<h1>Main Navigation</h1> <ul class="menu">
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/">
        <i class="fa fa-home fa-lg"></i> Accueil
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/schedule/">
        <i class="fas fa-calendar-alt"></i> Calendrier
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/lectures/">
        <i class="fas fa-book-reader"></i> Cours
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/discussions/">
        <i class="fas fa-user-graduate"></i> T. Dirigés
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/labs/">
        <i class="fas fa-laptop-code"></i> T. Pratiques
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/quizzes/">
        <i class="fas fa-question-circle"></i> Quiz
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/projects/">
        <i class="fas fa-user-graduate"></i> Projets
      </a>

    </li>
    
    <li>

      
      

      <a class="page-link" href="/l2ado/fr/materials/">
        <i class="fas fa-book"></i> Ressources
      </a>

    </li>
    
</ul>
 </div>  
    
    </nav>
  </div>

  <div></div>

  <div class="header-texture" style="height:100%; z-index: 0; position: absolute; top:0; right: 0; left: 0; background-image: url( /l2ado/_images/pattern.png );">
  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Compilation et débogage de programmes C sous environnement UN*X</h1>
    <p class="post-meta">Publié le 
      <!--
      Wednesday
      25/09/2024
      -->
      
      Mercredi
      25
      
      Septembre
      2024
    </p>
  </header>

  <div>
    
    <span style="font-weight: bold"> Echéance : 
      <!-- 03/10/2024 -->

      
      Jeudi
      3
      
      Octobre
      2024
    </span>
    

    <br>
    

    
    <p style="font-weight: bold">Télécharger

      

      
      [<a href="/l2ado/fr/static_files/labs/lab_01.zip"> démarrage</a>]
      

      
    </p>
        
  </div>

  <br>
  <article class="post-content">
    <h1 id="objectifs">Objectifs</h1>

<ul>
  <li>
    <p>Initiation aux commandes de base du shell UN*X.</p>
  </li>
  <li>
    <p>Introduction à l’outil GDB pour acquérir une expérience pratique dans le débogage de programmes C.</p>
  </li>
  <li>
    <p>Etre capable de compiler et d’exécuter un programme C sur les ordinateurs des salles TP (Linux).</p>
  </li>
</ul>

<h1 id="installation-et-configuration">Installation et configuration</h1>

<p>Pour les travaux pratiques de ce cours, il est suggéré d’effectuer l’installation / configuration suivante sur votre ordinateur personnel :</p>

<ol>
  <li>
    <p>Commencez par télécharger <strong>VirtualBox</strong> à partir du lien indiqué dans la rubrique « <strong>Ressources | Ressources Additionnelles</strong> » de ce site. Installez la version 6.1.x.</p>
  </li>
  <li>
    <p>Toujours depuis la même page de VirtualBox, téléchargez et installez le pack d’extension (Extension Pack) correspondant à la version de VirtualBox que vous venez d’installer sur votre machine.</p>
  </li>
  <li>
    <p>En suite, téléchargez et installez la machine virtuelle (VM) cvlab.ova” (1.7 Go) à partir de ce <a href="https://adminunivalger-my.sharepoint.com/:u:/g/personal/a_benhadid_univ-alger_dz/ETesIJvkYUpFnvuYjEfCe1UB_qNlQjxEe7dvmG0FwYRyug?e=ZfGlMu">lien</a> ou depuis la rubrique précédemment indiquée. Pour ajouter la VM à VirtualBox, suivez les instructions données <a href="https://docs.oracle.com/cd/E26217_01/E26796/html/qs-import-vm.html">ici</a>.</p>
  </li>
  <li>
    <p>C’est fini ! Vous disposez maintenant d’une machine virtuelle avec une configuration semblable aux machines des salles TP.</p>
  </li>
  <li>
    <p>Si votre ordinateur possède 4 Go ou plus de Mémoire RAM, il est préférable dans ce cas de reconfigurer la VM pour lui attribuer <a href="https://docs.bitnami.com/virtual-machine/faq/administration/increase-memory/">plus de mémoire</a>.</p>
  </li>
  <li>
    <p>Une fois la VM lancée, le système est configuré pour utiliser par défaut un <a href="#">clavier américain<img src="/l2ado/static_files/images/keyboard_us.png"></a> (comme dans les salles machines). Vous pouvez permuter vers un <a href="#">clavier français<img src="/l2ado/static_files/images/keyboard_fr.png"></a> en cliquant avec la souris sur le drapeau américain en haut à droite de l’écran.</p>
  </li>
</ol>

<p><strong>Remarque</strong> : Vous êtes libres d’installer / configurer vos propres PCs de la manière qui vous convient. Cependant, pour réaliser les travaux et devoirs de ce cours sans trop de difficultés et afin d’éviter les problèmes / excuses / frustrations du genre « pourquoi ça fonctionne sur mon PC mais pas sur le PC du labo ? », vous êtes vivement encouragés à installer la VM fournie en suivant les instructions données ci-dessus.</p>

<h1 id="exercice-1--shell-unx">Exercice 1 : (Shell UN*X)</h1>

<p>Afin d’acquérir un minimum d’expérience avec la ligne de commande (<em>anglais</em> : Command Line Interface - CLI) sous UN*X, nous introduisons ici quelques commandes courantes qui peuvent vous être utiles pendant ce cours. Pour une introduction aux commandes UN*X de base, consultez ce <a href="http://doc.ubuntu-fr.org/tutoriel/console_ligne_de_commande">didacticiel</a> et/ou ce <a href="https://tutorials.ubuntu.com/tutorial/command-line-for-beginners">didacticiel</a> (en anglais).</p>

<p>Les exemples de commandes seront affichés comme suit :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"Hello world"</span>
</code></pre></div></div>

<p>Entrez l’instruction ci-dessus (sans le $) dans un terminal exécutera la commande. Ici, l’instruction affiche simplement le message “Hello world” (sans les guillemets).</p>

<p>Les drapeaux (<em>anglais</em>: flags) sont utilisés pour spécifier éventuellement des options pour la commande à exécuter ou modifier son comportement. Ils commencent généralement par un ou deux tirets et peuvent éventuellement prendre un argument.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>gcc <span class="nt">--help</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Hello</span><span class="se">\n</span><span class="s2">world"</span>
</code></pre></div></div>

<h2 id="raccourcis-clavier">Raccourcis clavier</h2>

<p>Lors de la saisie de commandes dans un terminal UN*X :</p>

<ul>
  <li>
    <p>La touche <kbd>Tab</kbd> complétera automatiquement le terme actuel (cf. ce <a href="https://fr.wikipedia.org/wiki/Disposition_des_touches_d%27un_clavier_de_saisie">lien</a> pour la disposition des touches dans un clavier).</p>
  </li>
  <li>
    <p>Les touches <kbd>↑</kbd> et <kbd>↓</kbd> vous permettront de réutiliser les commandes que vous avez tapées précédemment sans les saisir à nouveau.</p>
  </li>
  <li>
    <p>La combinaison <kbd>Ctrl</kbd> + <code class="language-plaintext highlighter-rouge">a</code> déplacera le curseur au début de la ligne courante (utile pour corriger les erreurs).</p>
  </li>
  <li>
    <p>La combinaison <kbd>Ctrl</kbd>  + <code class="language-plaintext highlighter-rouge">e</code> déplacera le curseur à la fin de la ligne courante (également utile pour corriger les erreurs)</p>
  </li>
  <li>
    <p>La combinaison <kbd>Ctrl</kbd>  + <code class="language-plaintext highlighter-rouge">r</code> vous permettra d’effectuer une recherche dans la commande récemment utilisée.</p>
  </li>
</ul>

<h2 id="manipulation-de-fichiers">Manipulation de fichiers</h2>

<p>La commande <code class="language-plaintext highlighter-rouge">touch</code> permet de créer un fichier vide avec le nom de fichier fourni en argument.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">touch </span>example.txt
</code></pre></div></div>

<p>Cela créera un fichier vide nommé « exemple.txt ». Si vous souhaitez créer un fichier non vide (c.-à-d. avec du contenu), vous pouvez utiliser la commande</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"Votre contenu entre les guillemets"</span> <span class="o">&gt;</span> example.txt
</code></pre></div></div>

<p>Cela créera un fichier avec le nom « exemple.txt » dans le répertoire actuel. Si le fichier existe déjà alors il sera écrasé. Le (nouveau) fichier contiendra le texte “Votre contenu entre les guillemets” mais sans les guillemets.</p>

<p>Le symbole <code class="language-plaintext highlighter-rouge">&gt;</code> est suivi d’un argument pour rediriger la sortie de l’instruction <code class="language-plaintext highlighter-rouge">echo</code> qui est normalement transmise à <code class="language-plaintext highlighter-rouge">stdout</code> (c.-à-d. l’écran) vers un fichier (<em>ici</em> example.txt).</p>

<p>Vous pouvez également utiliser la commande <code class="language-plaintext highlighter-rouge">echo</code> sans redirection. Dans ce cas, elle affichera simplement la chaîne de caractères sur le terminal (sans création de fichier).</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"Hello world"</span>
</code></pre></div></div>

<p>Pour visualiser le contenu d’un fichier, vous pouvez utiliser les commandes <code class="language-plaintext highlighter-rouge">cat</code> ou<code class="language-plaintext highlighter-rouge"> less</code>.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>example.txt
<span class="gp">$</span><span class="w"> </span>less example.txt
</code></pre></div></div>

<p>La commande <code class="language-plaintext highlighter-rouge">cat</code> affiche le contenu de <code class="language-plaintext highlighter-rouge">example.txt</code> sur votre terminal. <code class="language-plaintext highlighter-rouge">less</code> lance un éditeur basique. Vous pouvez donner comme argument à <code class="language-plaintext highlighter-rouge">cat</code> ou <code class="language-plaintext highlighter-rouge">less</code> un chemin relatif ou absolu pour afficher le contenu de fichiers non locaux.</p>

<h2 id="man---pages-de-manuel">
<code class="language-plaintext highlighter-rouge">man</code> - Pages de manuel</h2>

<p>Les pages de manuel (<em>anglais</em> : « man pages ») sont d’excellentes ressources UN*X qui sont souvent sous-utilisées; bien qu’elles ne soient pas aussi polyvalentes que Google, elles contiennent de la documentation sur les composants UN*X comme les manuels d’utilisation des programmes, des normes et conventions linguistiques, etc. Elles fonctionnent également hors ligne et peuvent donc être utiles si vous êtes coincé sans internet parce que le cable sous-marin a été rupturé une n-ième fois (ou pendant la période du bac !).</p>

<p>Bien que votre moteur de recherche préféré ait probablement les réponses que vous recherchez, nous aimerions dans ce cours que vous vous familiarisiez avec l’utilisation de la commande « <code class="language-plaintext highlighter-rouge">man</code> », en particulier pour les questions relatives au langage C et au systèmes d’exploitation UN*X.</p>

<p>Pour afficher la page de manuel pour une commande spécifique (ici la commande <code class="language-plaintext highlighter-rouge">echo</code> est donnée en exemple), vous pouvez exécuter l’instruction :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>man <span class="nb">echo</span> | less
</code></pre></div></div>

<p>La page de manuel d’une commande contient généralement des informations sur celle-ci, la signification et l’effet de certains paramètres additionnels quand vous invoquez la commande avec eux, et où aller pour avoir plus d’informations.</p>

<p>Dans l’exemple ci-dessus, nous avons redirigé, grâce au symbole « <code class="language-plaintext highlighter-rouge">|</code> », le contenu du manuel d’utilisation de la commande <code class="language-plaintext highlighter-rouge">echo</code> vers le programme <code class="language-plaintext highlighter-rouge">less</code>. Cela nous permet de dérouler la page de manuel avec les touches fléchées ou la barre d’espace. Appuyez sur la touche <code class="language-plaintext highlighter-rouge">q</code> pour quitter la page de manuel et revenir à l’invite de votre terminal.</p>

<p>Si vous souhaitez rechercher dans les pages de manuel une commande relative à un mot-clé spécifique :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>man <span class="nt">-k</span> mot_clé_spécifique | less
</code></pre></div></div>

<p>Cette commande recherchera dans les pages de manuel toutes les commandes avec le mot-clé <code class="language-plaintext highlighter-rouge">mot_clé_spécifique</code>.</p>

<h2 id="vim---les-bases">Vim - les bases</h2>

<p>Vim est un éditeur de texte inclus dans de nombreuses distributions UN*X.</p>

<p><strong>Remarque</strong> : Nous utilisons Vim ici comme introduction aux éditeurs de texte en ligne de commande, mais nous n’avons aucune exigence stricte sur l’éditeur de texte que vous utiliserez; vous pouvez choisir l’éditeur de texte qui vous convient (<em>c.-à-d.</em> graphique ou en ligne de commande) ! Toutefois, nous aimerions rappeler que, en tant que futur informaticien, vous devez savoir utiliser au moins un éditeur de texte en ligne de commande. Si vous n’aimez pas Vim, vous pouvez essayer <code class="language-plaintext highlighter-rouge">nano</code> ou <code class="language-plaintext highlighter-rouge">emacs</code>!</p>

<p>Pour ouvrir un fichier à partir de votre répertoire actuel, donnez le nom du fichier à Vim :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>vim filename
</code></pre></div></div>

<p>Pour ouvrir un fichier à partir d’un autre répertoire, utilisez un chemin relatif ou absolu :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>vim ../other_folder/filename
</code></pre></div></div>

<h3 id="quelques-commandes-utiles-pour-vim-">Quelques commandes utiles pour Vim :</h3>

<table class="styled-table">
<colgroup>
<col width="12%">
<col width="88%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align:center">Commande</th>
<th style="text-align:center">Signification</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"> <kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">:q</code> </td>
<td style="text-align:left">Ferme (quitte) Vim sans enregistrer</td>
</tr>
<tr>
<td style="text-align:left">
<kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">:wq</code>
</td>
<td style="text-align:left">Quitte Vim après enregistrement des modifications</td>
</tr>
<tr>
<td style="text-align:left">
<kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">:w</code>
</td>
<td style="text-align:left">Enregistre le fichier</td>
</tr>
<tr>
<td style="text-align:left">
<kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">:q!</code>
</td>
<td style="text-align:left">Quitte Vim sans enregistrer (lorsque vous avez effectué des modifications mais vous ne souhaitez pas les garder) </td>
</tr>
<tr>
<td style="text-align:left">
<kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">i</code>
</td>
<td style="text-align:left">Mode “Insertion”, vous permet d’insérer des caractères dans le fichier</td>
</tr>
<tr>
<td style="text-align:left">
<kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">/cats</code> </td>
<td style="text-align:left">Recherche dans le fichier la première occurrence de la chaîne de caractères « cats ». Appuyez sur <code class="language-plaintext highlighter-rouge">n</code> pour aller à l’occurrence suivante ou <code class="language-plaintext highlighter-rouge">N</code> pour retourner à la précédente</td>
</tr>
<tr>
<td style="text-align:left">
<kbd>Esc</kbd><code class="language-plaintext highlighter-rouge">:setnu</code>
</td>
<td style="text-align:left">Affiche les numéros de ligne dans votre fichier</td>
</tr>
</tbody>
</table>

<p><strong>Remarque</strong> : Ces commandes sont précédées de <kbd>Esc</kbd> pour indiquer que vous devez appuyer sur la touche d’échappement (<em>anglais</em> Escape) de votre clavier pour quitter le mode actuel. Par exemple, si vous voulez enregistrer votre fichier après modification, vous devez appuyer sur la touche d’échappement pour sortir du mode « insertion », puis taper « <code class="language-plaintext highlighter-rouge">:w</code> » pour sauvegarder le fichier.</p>

<h1 id="exercice-2--gdb">Exercice 2 : (gdb)</h1>

<p>Un <strong>débogueur</strong>, comme son nom l’indique, est un programme spécialement conçu pour vous aider à trouver des bogues, ou des erreurs logiques et des fautes dans votre code (remarque : si vous voulez savoir pourquoi les erreurs sont appelées « bogues »,  consultez cette <a href="https://www.quora.com/Why-are-errors-in-software-codes-called-bugs">réponse</a>). Différents débogueurs possèdent des fonctionnalités différentes, mais ils permettent tous d’effectuer les opérations suivantes :</p>

<ol>
  <li>
    <p>Définir un « point d’arrêt » (<em>anglais</em>: breakpoint) dans le programme. Un « point d’arrêt » est une ligne spécifique dans votre code où vous souhaitez arrêter l’exécution du programme afin que vous puissiez examiner ce qui se passe dans cette région du code.</p>
  </li>
  <li>
    <p>Exécuter le programme pas à pas (anglais : step by step). Un code s’exécute toujours instruction par instruction, mais cela arrive trop rapidement pour que nous puissions déterminer quelles instructions ou parties du code causent des problèmes. Être capable d’examiner l’exécution de votre code pas à pas vous permet de déterminer exactement ce qui cause un bogue dans votre programme.</p>
  </li>
</ol>

<p>Pour cet exercice, le <a href="/l2ado/fr/static_files/docs/gdb5-refcard.pdf">document de référence GDB</a> vous sera très utile. GDB signifie « <strong>G</strong>NU <strong>D</strong>e-<strong>B</strong>ugger ». D’abord, téléchargez le fichier de démarrage (voir plus haut dans ce document) et <a href="https://itsfoss.com/unzip-linux/">décompressez</a> son contenu avec la commande <code class="language-plaintext highlighter-rouge">unzip</code> (cette commande est déjà installée sur la machine) dans le répertoire de votre choix. Compilez ensuite le fichier <code class="language-plaintext highlighter-rouge">hello.c</code> avec le drapeau <code class="language-plaintext highlighter-rouge">-g</code> (indiquez le chemin complet du fichier <code class="language-plaintext highlighter-rouge">hello.c</code> si différent du répertoire actuel ) :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>gcc <span class="nt">-g</span> <span class="nt">-o</span> exe hello.c
</code></pre></div></div>

<p>Cela instruit le compilateur <code class="language-plaintext highlighter-rouge">gcc</code> à stocker des informations supplémentaires dans le programme exécutable (<strong>exe</strong>) pour que l’outil <code class="language-plaintext highlighter-rouge">gdb</code>/<code class="language-plaintext highlighter-rouge">cgdb</code> puisse interprêter correctement votre programme compilé. Maintenant, lancez le débogueur <code class="language-plaintext highlighter-rouge">cgdb</code> en donnant le chemin de l’exécutable à déboguer comme paramètre :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>cgdb exe
</code></pre></div></div>

<p>L’instruction ci-dessus permet de lancer le programme <code class="language-plaintext highlighter-rouge">cgdb</code> sur le fichier exécutable<code class="language-plaintext highlighter-rouge"> exe</code> généré par <code class="language-plaintext highlighter-rouge">gcc</code>. N’essayez pas d’exécuter <code class="language-plaintext highlighter-rouge">cgdb</code> sur le code source <code class="language-plaintext highlighter-rouge">hello.c</code>, il ne saura pas quoi en faire ! Si <code class="language-plaintext highlighter-rouge">cgdb</code> ne fonctionne pas pour vous, essayez avec <code class="language-plaintext highlighter-rouge">gdb</code> (<em>c.-à-d.</em> exécutez la commande <code class="language-plaintext highlighter-rouge">gdb exe</code>). Le débogueur <code class="language-plaintext highlighter-rouge">cgdb</code> est installé par défaut sur les machines des salles TP et la machine virtuelle.</p>

<p><strong>Remarque</strong> : Si vous n’utilisez pas la VM fournie, vous pouvez installer <code class="language-plaintext highlighter-rouge">gdb</code> / <code class="language-plaintext highlighter-rouge">cgdb</code> sur votre ordinateur, mais sachez qu’il ne peut pas être installé sur des machines macOS (mises à jour). Si cela s’applique à vous, vous pouvez utiliser <code class="language-plaintext highlighter-rouge">lldb</code> qui est un autre excellent débogueur. Les commandes diffèrent légèrement de <code class="language-plaintext highlighter-rouge">gdb</code>, mais il existe d’excellents guides (<a href="Https://lldb.llvm.org/lldb-gdb.html">comme celui-ci !</a>) pour commencer. Pour ce TP, cependant, utilisez une des machines de votre salle TP (ou la VM) et <code class="language-plaintext highlighter-rouge">cgdb</code>.</p>

<h2 id="tâches-à-réaliser-">Tâches à réaliser :</h2>

<p>Parcourez le programme <code class="language-plaintext highlighter-rouge">hello</code> en procédant comme suit :</p>

<ol>
  <li>
    <p>définissez un point d’arrêt sur la fonction <code class="language-plaintext highlighter-rouge">main</code></p>
  </li>
  <li>
    <p>utilisez la commande <code class="language-plaintext highlighter-rouge">run</code> de <code class="language-plaintext highlighter-rouge">gdb</code></p>
  </li>
  <li>
    <p>utilisez la commande exécution pas-à-pas de <code class="language-plaintext highlighter-rouge">gdb</code></p>
  </li>
</ol>

<p>Tapez help depuis <code class="language-plaintext highlighter-rouge">gdb</code> pour connaître les commandes permettant d’effectuer ces opérations ou utilisez le <a href="/l2ado/fr/static_files/docs/gdb5-refcard.pdf">document de référence GDB</a>.</p>

<p>Si vous voyez un message d’erreur comme <strong>« printf.c: No such file or directory »</strong>, vous êtes probablement entré dans une fonction <code class="language-plaintext highlighter-rouge">printf</code> ! Si vous continuez l’exécution pas-à-pas, vous aurez l’impression d’aller nulle part ! CGDB se plaint parce que vous n’avez pas le fichier source où <code class="language-plaintext highlighter-rouge">printf</code> est défini. Pour sortir de cette impasse, utilisez la commande <code class="language-plaintext highlighter-rouge">finish</code> pour exécuter le programme jusqu’au retour de la fonction non définie (dans ce cas, jusqu’à ce que <code class="language-plaintext highlighter-rouge">printf</code> soit terminée). Pour éviter ce genre de mésaventure la PROCHAINE fois, utilisez la commande <code class="language-plaintext highlighter-rouge">next</code> pour sauter la ligne où <code class="language-plaintext highlighter-rouge">printf</code> est affichée.</p>

<h2 id="note--cgdb-vs-gdb">Note : cgdb vs. gdb</h2>

<p>Dans cet exercice, nous utilisons <code class="language-plaintext highlighter-rouge">cgdb</code> pour déboguer nos programmes. <code class="language-plaintext highlighter-rouge">cgdb</code> est identique à <code class="language-plaintext highlighter-rouge">gdb</code>, sauf qu’il fournit des fonctionnalités supplémentaires qui le rendent plus agréable à utiliser en pratique. Toutes les commandes du « document de référence GDB » fonctionnent avec <code class="language-plaintext highlighter-rouge">gdb</code>.</p>

<p>Dans <code class="language-plaintext highlighter-rouge">cgdb</code>, vous pouvez appuyer sur la touche d’échappement pour aller à la fenêtre de code (en haut) et <code class="language-plaintext highlighter-rouge">i</code> pour revenir à la fenêtre de commande (en bas) - similaire à Vim. La fenêtre de commande est l’endroit où vous entrerez vos commandes <code class="language-plaintext highlighter-rouge">gdb</code>.</p>

<h2 id="tâches-à-réaliser--1">Tâches à réaliser :</h2>

<p>Connaître les réponses aux questions ci-dessous vous sera très utile pour le reste de ce TP et pour votre carrière en informatique en général :</p>

<ol>
  <li>
    <p>Lorsque vous êtes dans une session <code class="language-plaintext highlighter-rouge">cgdb</code> / <code class="language-plaintext highlighter-rouge">gdb</code>, comment <strong>définissez-vous les arguments</strong> qui seront transmis au programme lors de son exécution ?</p>
  </li>
  <li>
    <p>Comment faire pour créer un « point d’arrêt » dans un programme ?</p>
  </li>
  <li>
    <p>Comment exécuter <strong>la ligne suivante dans le code</strong> après s’être arrêté à un « point d’arrêt » ?</p>
  </li>
  <li>
    <p>Si la ligne de code suivante est un appel de fonction alors vous exécuterez la fonction complète en un seul coup si vous utilisez votre réponse à la question n° 3 (Sinon, envisagez une commande différente pour la question n° 3 !). Comment indiquer à GDB que vous <strong>voulez déboguer le code à l’intérieur de la fonction</strong> (c’est-à-dire entrer dans la fonction) ? (Si vous avez changé votre réponse à la question n° 3 alors la réponse précédente est probablement applicable ici.)</p>
  </li>
  <li>
    <p>Comment <strong>continuer l’exécution du programme après sa suspension</strong> à un « point d’arrêt » ?</p>
  </li>
  <li>
    <p>Comment <strong>imprimer la valeur d’une variable</strong> (ou même une expression comme 1 + 2) dans <code class="language-plaintext highlighter-rouge">gdb</code> ?</p>
  </li>
  <li>
    <p>Comment configurer <code class="language-plaintext highlighter-rouge">gdb</code> pour qu’il <strong>affiche la valeur d’une variable après chaque pas d’exécution</strong> ?</p>
  </li>
  <li>
    <p>Comment afficher <strong>une liste de toutes les variables et leurs valeurs</strong> dans la fonction en cours d’exécution ?</p>
  </li>
  <li>
    <p>Comment <strong>quitter</strong> gdb ?</p>
  </li>
</ol>

<h1 id="exercice-3--valgrind">Exercice 3 : (Valgrind)</h1>

<p>Même avec un débogueur, nous ne pourrons peut-être pas détecter tous les bogues. Certains bogues sont ce que nous appelons des « bohrbugs », ce qui signifie qu’ils se manifestent de manière fiable dans un ensemble de conditions bien définies, mais peut-être inconnues. D’autres bogues sont ce que nous appelons des « heisenbugs », et au lieu d’être déterminants, ils sont connus pour disparaître ou modifier leur comportement lorsque l’on tente de les étudier. Nous pouvons détecter le premier type avec des débogueurs, mais le second type peut passer sous notre radar car ils sont souvent dus (au moins dans le langage C) à une mémoire mal gérée.</p>

<p>Rappelons que, contrairement à d’autres langages de programmation, le C s’attend à ce que vous (le programmeur) gériez correctement la mémoire. Pour détecter et attraper ces « heisenbugs », nous utiliserons un outil appelé <strong>Valgrind</strong>. Cet outil est un programme qui émule votre processeur et répertorie tous vos accès mémoire. Cela ralentit considérablement le processus que vous exécutez (c’est pourquoi, par exemple, nous n’exécutons pas toujours tous les exécutables à l’intérieur de Valgrind), mais permet d’exposer des bogues qui peuvent autrement passer inaperçus.</p>

<p><strong>Remarque</strong> : Valgrind est déjà installé sur les machines des salles TP et la VM. Cet outil est également disponible sur la plupart des distributions UN*X ainsi que sur macOS. Nous vous recommandons, toutefois, d’utiliser les machines des salles TP ou la VM fournie avec ce cours pour éviter d’éventuelles problèmes de compatibilité. Les outils GDB et Valgrind deviendront incroyablement utiles pour vous au fur et à mesure que vous avancerez dans votre carrière d’informaticien.</p>

<p>Dans cet exercice, nous allons démontrer deux exemples d’utilisation de Valgrind et expliquer comment ils peuvent être utile.</p>

<p>À l’aide du compilateur <code class="language-plaintext highlighter-rouge">gcc</code>, construisez deux exécutables :</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">segfault_ex</code> à partir de <code class="language-plaintext highlighter-rouge">segfault_ex.c</code>, et</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">no_segfault_ex</code> à partir de <code class="language-plaintext highlighter-rouge">no_segfault_ex.c</code>.</p>
  </li>
</ul>

<p>Utilisez le drapeau <code class="language-plaintext highlighter-rouge">-o</code> pour les noms d’exécutable ! Ensuite, essayez d’exécuter les programmes compilés…</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>./segfault_ex
<span class="gp">$</span><span class="w"> </span>./no_segfault_ex
</code></pre></div></div>

<p>Qu’observez-vous ? Commençons par <code class="language-plaintext highlighter-rouge">segfault_ex</code>. Vous devriez avoir observé une erreur de segmentation (<em>anglais</em>: segmentation fault), qui se produit lorsque un programme se bloque après avoir tenté d’accéder à de la mémoire qui ne lui est pas disponible (nous en parlerons plus tard dans le cours). Le code source <code class="language-plaintext highlighter-rouge">segfault_ex.c</code> est assez simple, vous devriez pouvoir « comprendre » facilement ce qui cause l’erreur de segmentation. Ne modifiez pas le fichier, il n’est pas nécessaire de corriger l’erreur ici.</p>

<p>Trouver une erreur de segmentation dans un fichier très large ne sera pas une tâche facile, et c’est là où Valgrind peut intervenir. Pour exécuter le programme <code class="language-plaintext highlighter-rouge">segfault_ex</code> dans Valgrind, utilisez la commande :</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>valgrind ./segfault_ex
</code></pre></div></div>

<p>Cela devrait amener Valgrind à afficher l’endroit où l’accès illégal s’est produit. Comparez ces résultats à ce que vous avez déterminé en examinons manuellement le fichier <code class="language-plaintext highlighter-rouge">segfault_ex.c</code>. Comment Valgrind pourrait-il vous aider à identifier un segfault dans l’avenir ?</p>

<p>Maintenant, essayez d’exécuter Valgrind sur <code class="language-plaintext highlighter-rouge">no_segfault_ex</code>. Le programme ne devrait pas planter mais il y a toujours un problème avec le fichier. Valgrind peut nous aider à trouver le problème (apparemment invisible).</p>

<p>Malheureusement, vous verrez ici que Valgrind semble ne pas être en mesure de vous dire exactement où le problème se produit. Utilisez le message fourni par Valgrind <strong>pour déterminer quelle variable a un comportement non défini, puis essayez de déduire ce qui a dû se passer</strong> (Indication : qu’est-ce qu’une valeur non initialisée ?).</p>

<p>À ce stade, nous ne nous attendons pas à ce que vous soyez familier avec l’utilisation du mot-clé <code class="language-plaintext highlighter-rouge">sizeof</code> dans un programme en langage C. Mais, vous pouvez, néanmoins, construire une certaine intuition autour de l’endroit où le problème s’est probablement produit.</p>

<h2 id="tâches-à-réaliser--2">Tâches à réaliser :</h2>

<p>Après avoir parcouru cet exercice, vous devriez être en mesure de comprendre et de répondre à ce qui suit :</p>

<ul>
  <li>
    <p>Pourquoi <strong>Valgrind</strong> est un outil important et très utile ?</p>
  </li>
  <li>
    <p>Comment exécuter un programme dans Valgrind ?</p>
  </li>
  <li>
    <p>Comment interpréter les messages d’erreur ?</p>
  </li>
  <li>
    <p>Pourquoi des variables non initialisées pourraient causer des « heisenbugs » ?</p>
  </li>
</ul>

<h1 id="exercice-4-makefile">Exercice 4 (Makefile)</h1>

<p>La compilation manuelle de programmes C dans le terminal est une opération fastidieuse et longue qui nécessite l’exécution de plusieurs commandes avec de longues séries d’arguments. Bien que cela soit acceptable pour compiler de petits programmes en C, les choses deviennent très vite ingérable dès qu’il s’agit de compiler des programmes avec des dizaines de fichiers et de dépendances.</p>

<p>De ce fait, la plupart des programmeurs en langage C écrivent ce que l’on appelle un « Makefile » pour faciliter la compilation et l’exécution des programmes. Un « Makefile » est un fichier texte (littéralement appelé « Makefile ») et contient un ensemble de règles. Chacune de ces règles spécifie des commandes à exécuter pour manipuler un programme (ex : compiler un fichier source, effacer l’exécutable, etc). Une fois le fichier « Makefile » préparé, nous avons seulement besoin de taper l’instruction ‘make’ dans la console de commande pour effectuer les tâches indiquées dans le « Makefile ».</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="c"># 1) pour compiler puis exécuter le programme hello </span>
<span class="gp">$</span><span class="w"> </span>make hello
<span class="gp">$</span><span class="w"> </span>./hello
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="c"># 2) pour compiler tous les programmes</span>
<span class="gp">$</span><span class="w"> </span>make 
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="c"># 3) pour exécuter Valgrind sur le programme segfault_ex déjà compilé</span>
<span class="gp">$</span><span class="w"> </span>make segfault_ex-memcheck
</code></pre></div></div>

<p>Consultez le « Makefile » inclus dans ce TP et essayez de répondre aux questions suivantes (Les réponses sont disponibles en cliquant sur le caractère   ▸   à gauche de chaque question). Pour apprendre davantage sur les Makefiles, Google est votre ami <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">.</p>

<fieldset class="checkoff">
 <legend>Contrôle</legend>

  <details close="">
  <summary>  
  Quelle cible (<i>anglais</i> : target) fait partie d'une règle qui supprime tous les programmes compilés ?  
  </summary>
  <p style="color: firebrick">
  C’est la cible « <code class="language-plaintext highlighter-rouge">clean:</code> » dans <strong>notre</strong> Makefile.
  </p>
  </details>
  <br>

  <details close="">
  <summary>  
  Quelle cible fait partie d'une règle qui permet de compiler tous les programmes ?
  </summary>
  <p style="color: firebrick">
  C’est la cible « <code class="language-plaintext highlighter-rouge">all:</code> » dans <strong>notre</strong> Makefile.
  </p>
  </details>
  <br>

  <details close="">
  <summary>  
  Quel compilateur est actuellement utilisé dans notre Makefile ?
  </summary>
  <p style="color: firebrick">
  La variable CC dans <strong>notre</strong> Makefile définie le compilateur C utilisé. Ici, c’est le compilateur gcc de chez <a href="https://gcc.gnu.org/">GNU</a>.
  </p>
  </details>
  <br>

  <details close="">
  <summary>  
  Quelle norme C utilisons-nous actuellement ?
  </summary>
  <p style="color: firebrick">
  La norme de langage utilisée dans un code source peut être définie avec le paramètre <code class="language-plaintext highlighter-rouge">-std=&lt;norme&gt;</code> dans un compilateur. Ici nous indiquons que les fichiers sources obéissent à la norme <a href="https://en.wikipedia.org/wiki/C99">C99</a> du langage C.
  </p>
  </details>
  <br>

  <details close="">
  <summary>  
  Comment est référencé une variable « FOO » dans un Makefile ?
  </summary>
  <p style="color: firebrick">
  La syntaxe <code class="language-plaintext highlighter-rouge">$(FOO)</code> fait référence à la variable FOO dans un Makefile.
  </p>
  </details>
  <br>

  <details close="">
  <summary>  
  Quel système d'exploitation le terme « Darwin » représente-t-il ?
  </summary>
  <p style="color: firebrick">
  Le terme « Darwin » retourné par la commande de shell <code class="language-plaintext highlighter-rouge">uname -s</code> indique que le système est un macOS.
  </p>
  </details>
  <br>

  <details close="">
  <summary>  
  Quelle ligne crée l'exécutable <b>hello</b> à partir de ses fichiers objets ?
  </summary>
  <p style="color: firebrick">
  La cible « <code class="language-plaintext highlighter-rouge">$(hello_PROG):</code> » dans le Makefile.
  </p>
  </details>
  <br>
</fieldset>

<!-- Un << Makefile >> a l'air intimidant, mais est en fait un outil formidable qui permet de gagner beaucoup de temps ! -->

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <!--     <h2 class="footer-heading"></h2> -->
    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">

        <p class="text">
          02 rue Didouche Mourad<br>
16000 Alger<br>
 
        </p>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">


          

          

          

          

          
          




        </ul>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
